"use strict";class MemberPictureFeedUploadApp{constructor(e,t,r){this.requestToken=e,this.pageId=t,this.pageLanguage=r}initialize(){let e=this.requestToken,t=this.pageId,r=this.pageLanguage,a=document.querySelector(".modal.member-picture-feed-caption-modal"),s;for(let o of["click","touchmove"]){let i=document.querySelectorAll(".remove-image");if(i)for(let n of i)n.addEventListener(o,function(t){t.preventDefault();let r=n.closest("[data-file-id]");if(r&&void 0!==(s=r.getAttribute("data-file-id"))){let a=new FormData;a.append("REQUEST_TOKEN",e),a.append("fileId",s),fetch("_member_picture_feed_xhr/remove_image",{method:"POST",headers:{"x-requested-with":"XMLHttpRequest",Accept:"application/json"},body:a}).then(e=>e.json()).then(e=>{e.message&&("success"===e.status||console.error(e.message)),"success"===e.status?(r.remove(),location.reload()):console.error("Server error!!!")}).catch(e=>{console.error("Error:",e)})}})}for(let d of["click","touchmove"]){let p=document.querySelectorAll(".rotate-image");if(p)for(let c of p)c.addEventListener(d,function(t){t.preventDefault();let r=c.closest("[data-file-id]");if(r&&void 0!==(s=r.getAttribute("data-file-id"))){let a=new FormData;a.append("REQUEST_TOKEN",e),a.append("fileId",s),fetch("_member_picture_feed_xhr/rotate_image",{method:"POST",headers:{"x-requested-with":"XMLHttpRequest",Accept:"application/json"},body:a}).then(e=>e.json()).then(e=>{e.message&&("success"===e.status||console.error(e.message)),"success"===e.status?location.reload():console.error("Server error!!!")}).catch(e=>{console.error("Error:",e)})}})}let l=document.querySelectorAll("button.add-caption");if(l)for(let u of l)u.addEventListener("click",o=>{o.preventDefault();let i=u.closest("[data-file-id]");if(i){s=i.getAttribute("data-file-id");let n=i.getAttribute("data-src");if(s){let d=a,p=bootstrap.Modal.getOrCreateInstance(a);d.querySelector(".image-full-res").setAttribute("src",n);let c=new FormData;c.append("REQUEST_TOKEN",e),c.append("pageLanguage",r),c.append("pageId",t),c.append("fileId",s),fetch("_member_picture_feed_xhr/get_image_data",{method:"POST",headers:{"x-requested-with":"XMLHttpRequest",Accept:"application/json"},body:c}).then(e=>e.json()).then(e=>{e.message&&("success"===e.status||console.error(e.message)),"success"===e.status?(document.getElementById("imageCaptionInput").value=e.caption,document.getElementById("imagePhotographerInput").value=e.photographer,p.show()):console.error("Server error!!!")}).catch(e=>{console.error("Error:",e)})}}});document.getElementById("saveCaptionButton").addEventListener("click",()=>{let t=a,o=bootstrap.Modal.getOrCreateInstance(a),i=t.querySelector('[name="image-caption"]').value,n=t.querySelector('[name="image-photographer"]').value;o.hide();let d=new FormData;d.append("REQUEST_TOKEN",e),d.append("pageLanguage",r),d.append("caption",i),d.append("photographer",n),d.append("fileId",s),fetch("_member_picture_feed_xhr/set_caption",{method:"POST",headers:{"x-requested-with":"XMLHttpRequest",Accept:"application/json"},body:d}).then(e=>e.json()).then(e=>{e.message&&("success"===e.status||console.error(e.message))}).catch(e=>{console.error("Error:",e)})})}}